<section class="new">
	<div class="container">
		<h2>Редактирование проекта</h2>
		<div class="col-sm-9">
			<form action="#" id="form-new">
				<div class="new-wrapper new-title">
					<h3>Название проекта</h3>
					<p class="new-tint">Простое, запоминающееся, отражающее суть проекта</p>
					<input id="new-title" name="title" type="text" placeholder="Введите название проекта" value="Название проекта">
				</div>
				<div class="new-wrapper new-image">
					<h3>Обложка проекта</h3>
					<label class="button button_purple" for="new-image">Загрузить изображение</label>
					<input id="new-image" type="file"  accept="image/jpeg,image/png,image/gif">
					<img id="new-image-loading" src="img/svg/loading.svg" alt=".">
					<input id="new-image-url" type="hidden" value="Ссылка на картинку">
				</div>
				<div class="new-wrapper new-desc-short">
					<h3>О проекте в одном предложении</h3>
					<p class="new-tint">Будет отображаться в каталоге проектов</p>
					<input id="new-desc-short" name="new-desc-short" type="text" placeholder="Введите краткое описание">
				</div>
				<div class="new-wrapper new-category">
					<h3>Категория</h3>
					<select name="new-category" id="new-category">
						<option value="Информационные технологии">Информационные технологии</option>
						<option value="Здоровье">Здоровье</option>
						<option value="Предложить свою">Предложить свою</option>
					</select>
					<input type="hidden" placeholder="Введите название категории">
				</div>
				<div id="new-city" class="new-wrapper new-city">
					<h3>Город</h3>
					<select name="new-city" id="new-city">
						<option value="Санкт-Петербург">Санкт-Петербург</option>
						<option value="Москва">Москва</option>
						<option value="Казань">Казань</option>
						<option value="Новосибирск">Новосибирск</option>
					</select>
				</div>
				<div class="new-wrapper new-budget">
					<h3>Бюджет</h3>
					<input step="500" id="new-budget" type="number"> ₽
				</div>
				<div class="new-wrapper new-date">
					<h3>Дата старта</h3>
					<input id="new-date-start" type="date">
				</div>
				<div class="new-wrapper new-date">
					<h3>Дата завершения</h3>
					<input id="new-date-end" type="date">
				</div>
				<div class="new-wrapper new-description">
					<h3>Полное описание</h3>
					<textarea></textarea>
				</div>
				<div class="new-wrapper new-submit">
					<input class="button button_purple" type="submit" value="Обновить проект">
				</div>
			</form>
		</div>
		<div class="col-sm-3">
			<div class="new-preview">
				<div class="catalog-card">
					<a href="project.html">
						<img id="catalog-card-preview" src="img/catalog/project.jpg" alt="">
						<h3>Название стартапа в две строки максимум</h3>
					</a>
					<div class="catalog-author">Автор: <a href="#">Владислав Кирилёнок</a></div>
					<p>Краткое описание проекта (должно обрезаться, если введено слишком много текста Далеко-далеко за словесными горами в стране, гласных и согласных живут рыбные тексты.</p>
					<a href="#" class="catalog-geo">
						<span>Санкт-Петербург, Россия</span>
					</a>
					<div class="catalog-progress">
						<div class="catalog-status catalog-status_open">
							Статус проекта: <span>Открыт</span>
						</div>
						<div class="catalog-money">
							<span>Бюджет:</span>18.000	
						</div>
					</div>
					<div class="catalog-dates">
						<div class="catalog-dates-start">
							<span>Начало:</span> 10 Декабря 2017
						</div>
						<div class="catalog-dates-end">
							<span>Конец:</span> 18 Декабря 2017
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</section>

<!-- Начало скиптов -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<script>
		$('#new-title').on('keyup', function(){
			var content = $(this).val();
			$('.new-preview h3').html(content);
		});
		$('#new-desc-short').on('keyup', function(){
			var content = $(this).val();
			$('.new-preview p').html(content);
		});
		$('#new-city').on('change', function(){
			var content = $('#new-city option:selected').val();
			$('.new-preview .catalog-geo span').html(content);
		});
		$('#new-budget').on('keyup', function(){
			var content = $(this).val();
			$('.new-preview .catalog-money').html('<span>Бюджет</span> ' + content.replace(/(\d)(?=(\d\d\d)+([^\d]|$))/g, '$1'));
		});
		$('#new-date-start').on('change',function(){
			var date = new Date($(this).val());
			var options = {
			  year: 'numeric',
			  month: 'long',
			  day: 'numeric'
			};
			var dateStr = date.toLocaleString('ru', options);
			dateStr = dateStr.replace(' г.','');
			$('.catalog-dates-start').html('<span>Начало:</span> ' + dateStr);
		})
		$('#new-date-end').on('change',function(){
			var date = new Date($(this).val());
			var options = {
			  year: 'numeric',
			  month: 'long',
			  day: 'numeric'
			};
			var dateStr = date.toLocaleString('ru', options);
			dateStr = dateStr.replace(' г.','');
			console.log(dateStr);
			$('.catalog-dates-end').html('<span>Конец:</span> ' + dateStr);
		})
		$('#new-image').on('change', function(){
			var image = $(this)[0].files[0];
			$('#new-image-loading').show();
			$.ajax({
				url: '',
				data: 'image',
				processData: false,
				contentType: false,
				type: 'POST',
				success: function () {
					var url = $('#new-image-url').value();
					$('#catalog-card-preview').attr('src', url);
					$('#new-image-loading').hide();
				},
				error: function () {
					alert('Ошибка загрузки файла');
					$('#new-image-loading').hide();
				}
			});
		});
	</script>